<MudForm @bind-IsValid="@_isValid">
	<MudExpansionPanels>
		<MudExpansionPanel HideIcon="true" @bind-IsExpanded="_isMultiPlayer">
			<TitleContent>
				<MudToolBar>
					<MudSwitch Color="Color.Primary" @bind-Checked="_isMultiPlayer" Label="Modalità Multiplayer" />
				</MudToolBar>
			</TitleContent>
			<ChildContent>
				@if (_isMultiPlayer)
				{
					int i = 1;
					@foreach (var player in _players)
					{
						<MudTextField @bind-Value="player.Name"
									  Required="true"
									  Label="@($"Player #{i}")"
									  Variant="Variant.Outlined" />
						i++;
					}
					<MudButton Color="Color.Primary" Variant="Variant.Filled" OnClick="AddPlayer">Aggiungi Player</MudButton>
				}
			</ChildContent>
		</MudExpansionPanel>
	</MudExpansionPanels>

	<MudButton Color="Color.Primary"
			   Variant="Variant.Filled"
			   Disabled="@(_isMultiPlayer && !_isValid)"
			   OnClick="Start">Start!</MudButton>
</MudForm>

@code {

	[CascadingParameter]
	public Game? Game { get; set; }

	private bool _isValid;

	private bool _isMultiPlayer = true;
	private List<Player> _players = [new Player(), new Player()];

	private void AddPlayer()
	{
		_players.Add(new Player());
	}

	private void Start()
	{
		//Game!.Status = Status.Ongoing;
		Game = new Game() { Status = Status.Ongoing };
	}
}
